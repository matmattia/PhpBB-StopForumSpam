<!-- INCLUDE overall_header.html -->
<link href="http://weloveiconfonts.com/api/?family=fontelico" rel="stylesheet" />
<script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
<script type="text/javascript">
var stopforumspam = {
	'init': function() {
		$.getJSON('http://www.stopforumspam.com/api?{SFS_P}&f=jsonp&callback=?', function(res) {
			if (res && res.success && res.success == 1) {
				var l = res.email.length, i = 0,
					users = {SFS_USERS_JSON}, users_l = users.length, j = 0,
					ban_emails = [], td = null;
				for (i = 0; i < l; i++) {
					for (j = 0; j < users_l; j++) {
						if (users[j].USER_EMAIL == res.email[i].value) {
							td = $('#sfs_result_' + users[j].USER_ID);
							if (td.length > 0) {
								td.removeClass('fontelico-spin4');
								if (res.email[i].appears == 1) {
									td.addClass('fontelico-emo-angry').css('color', '#F00').append($('<a />').attr('href', '#').addClass('button2').click(function() {
										var a = $(this);
										stopforumspam.deleteUser(a.data('user_id'), a.closest('tr'));
										return false;
									}).data('user_id', users[j].USER_ID).text('{L_DELETE} & {L_ACP_BAN_EMAILS}'));
									ban_emails.push(res.email[i]['value']);
								} else {
									td.addClass('fontelico-emo-saint');
									if ('{SFS_API_KEY}' != '') {
										td.append($('<a />').attr('href', '#').addClass('button2').click(function() {
											var a = null;
											if (confirm('{L_CONFIRM_OPERATION}')) {
												a = $(this);
												stopforumspam.sendSpamData(a.data('user_id'), a.data('username'), a.data('user_email'), a.data('user_ip'), a.closest('tr'));
											}
											return false;
										}).data({
											'user_id': users[j].USER_ID,
											'username': users[j].USERNAME,
											'user_email': users[j].USER_EMAIL,
											'user_ip': users[j].USER_IP
										}).text('{L_DELETE} & {L_ACP_BAN_EMAILS}'));
									}
								}
							}
							break;
						}
					}
				}
			}
		});
	},
	'deleteUser': function(user_id, tr) {
		$.ajax({
			'url': '{SFS_USERS_DELETE_URL}',
			'type': 'post',
			'data': {
				'delete_user': user_id
			},
			'dataType': 'json',
			'success': function(res) {
				if (res && res.ok && res.ok == 1) {
					$(tr).css('opacity', 0.5);
				}
			}
		});
	},
	'sendSpamData': function(user_id, username, email, ip, tr) {
		$.ajax({
			'url': 'http://www.stopforumspam.com/add.php',
			'type': 'post',
			'data': {
				'username': username,
				'ip_addr': ip,
				'email': email,
				'api_key': '{SFS_API_KEY}'
			},
			'complete': function() {
				stopforumspam.deleteUser(user_id, tr);
			}
		});
	}
};

$(document).ready(function() {
	stopforumspam.init();
});
</script>
<div class="pagination"><!-- IF SFS_PAGINATION --><a href="#" onclick="jumpto();return false;" title="{L_JUMP_TO_PAGE}">{SFS_PAGE_NUMBER}</a> &bull; <span>{SFS_PAGINATION}</span><!-- ELSE -->{SFS_PAGE_NUMBER}<!-- ENDIF --></div>
<h1>{L_USERS}</h1>
<table cellspacing="1">
	<thead>
		<tr>
			<th>ID</th>
			<th>{L_USERNAME}</th>
			<th>{L_EMAIL}</th>
			<th>{L_IP}</th>
			<th></th>
			<th></th>
		</tr>
	</thead>
	<tbody>
		<!-- BEGIN users -->
			<!-- IF users.S_ROW_COUNT is even -->
				<tr class="row1">
			<!-- ELSE -->
				<tr class="row2">
			<!-- ENDIF -->
				<td>{users.USER_ID}</td>
				<td>{users.USERNAME}</td>
				<td>{users.USER_EMAIL}</td>
				<td>{users.USER_IP}</td>
				<td id="sfs_result_{users.USER_ID}" class="fontelico-spin4" style="font-family: 'fontelico';">&nbsp;</td>
				<td><a href="{users.URL}" class="button2">{L_GO}</a></td>
			</tr>
		<!-- END users -->
	</tbody>
</table>
<!-- INCLUDE overall_footer.html -->